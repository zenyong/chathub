(this.webpackJsonpchatbud=this.webpackJsonpchatbud||[]).push([[0],{31:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(22),i=n.n(a),c=n(16),s=n(13),o=n.n(s),l=n(15),d=n(12),j=(n(31),n(19)),u=n.n(j),x=n(42),p=n(43),b=n(44),m=n(45),h=n(46),f=n(10),g=(n(39),n(34),n(37),n(24)),O=n(21),y=n(1);f.a.initializeApp({apiKey:"AIzaSyBOdfX_-WBub3AIHChW_Qh9aK6J0bLsung",authDomain:"chatbud-80653.firebaseapp.com",projectId:"chatbud-80653",storageBucket:"chatbud-80653.appspot.com",messagingSenderId:"319960267783",appId:"1:319960267783:web:d59f1e81f4975140803ea2"});var v=f.a.auth(),w=f.a.firestore();function F(){return Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"center",height:"100vh",width:"100vw",backgroundColor:""},children:[Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(y.jsx)("img",{src:"https://i.pinimg.com/564x/00/7e/28/007e285cbf44017f5bc63cce986dddda.jpg",style:{height:"300px",width:"300px",margin:"0"}}),Object(y.jsx)("h1",{style:Object(c.a)({fontSize:"2rem",color:"white",width:"100vw",fontWeight:"1000",margin:"0"},"color","#007AFF"),children:"Imagine a place..."}),Object(y.jsx)("h2",{style:{fontSize:"1rem",width:"95vw",height:"min-content",color:"#007AFF",textAlign:"center",lineHeight:"1.5rem",margin:"0"},children:"...where you can belong to a school club, a gaming group, or a worldwide art community. A place that makes it easy to talk every day and hang out more often."})]}),Object(y.jsxs)("button",{className:"sign-in",onClick:function(){var e=new f.a.auth.GoogleAuthProvider;v.signInWithPopup(e)},children:[" ",Object(y.jsx)(b.a,{})," Sign in with Google"]})]})})}function S(){return v.currentUser&&Object(y.jsx)("button",{className:"sign-out",onClick:function(){return v.signOut()},children:Object(y.jsx)(m.a,{style:{fontSize:"28px"}})})}function k(e){var t=Object(r.useRef)(),n=w.collection("messages"),a=n.orderBy("createdAt").limit(250),i=Object(O.a)(a,{idField:"id"}),c=Object(d.a)(i,1)[0],s=w.collection("allRooms").doc(e.currentRoom),j=Object(r.useState)(""),x=Object(d.a)(j,2),p=x[0],b=x[1];Object(r.useEffect)((function(){t.current.scrollIntoView()}),[c],w.collection("allRooms"));var m=function(){var r=Object(l.a)(o.a.mark((function r(a){var i,c,l,d,j;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a.preventDefault(),i=v.currentUser,c=i.uid,l=i.photoURL,d=i.displayName,j=String(u()().format("h:mm a")),r.next=5,n.add({text:p,createdAt:f.a.firestore.FieldValue.serverTimestamp(),uid:c,photoURL:l,displayName:d,roomName:e.currentRoom,time:j});case 5:return r.next=7,s.update({LastMessage:p,LastMessageSender:d,LastMessageTime:f.a.firestore.FieldValue.serverTimestamp()});case 7:b(""),t.current.scrollIntoView({behavior:"smooth"});case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)("main",{children:[c&&c.map((function(t){return t.roomName===e.currentRoom?Object(y.jsx)(A,{message:t},t.id):Object(y.jsx)("div",{})})),Object(y.jsx)("span",{ref:t})]}),Object(y.jsx)("form",{onSubmit:m,children:Object(y.jsxs)("div",{className:"message_box",children:[Object(y.jsx)("input",{value:p,onChange:function(e){return b(e.target.value)},placeholder:"Message..."}),Object(y.jsx)("button",{type:"submit",disabled:!p,className:"sendbtn",children:Object(y.jsx)(h.a,{style:{fontSize:"25px"}})})]})})]})}function A(e){var t,n=e.message,r=n.text,a=n.uid,i=n.displayName,s=(n.createdAt,n.time),o=a===v.currentUser.uid?"sent":"received";return Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)("div",{className:"message ".concat(o),children:[Object(y.jsx)("img",{className:o,src:"https://avatars.dicebear.com/api/miniavs/"+a+".svg",alt:""}),Object(y.jsxs)("p",{className:"messageText",children:[Object(y.jsx)("span",{children:Object(y.jsx)("font",(t={size:"1",color:"#007AFF",className:"username"},Object(c.a)(t,"className","username".concat(o)),Object(c.a)(t,"children",i),t))}),r,Object(y.jsx)("span",{style:{width:"100%",textAlign:"end",lineHeight:"9px"},children:Object(y.jsx)("font",{size:"1",color:"gray",style:{textAlign:"right"},children:s})})]})]})})}var N=function(){var e=Object(g.a)(v),t=Object(d.a)(e,1)[0],n=Object(r.useState)(!1),a=Object(d.a)(n,2),i=a[0],c=a[1],s=Object(r.useState)(""),j=Object(d.a)(s,2),b=j[0],m=j[1],h=[];function A(){var e=v.currentUser,n=e.uid,a=e.displayName,s=w.collection("allRooms"),j=Object(O.a)(s,{idField:"id"}),p=Object(d.a)(j,1)[0];w.collection("joined").doc(n).get().then((function(e){(h=[]).push(e.data())}));var g=Object(r.useState)(""),F=Object(d.a)(g,2),S=F[0],A=F[1],N=Object(r.useState)(""),C=Object(d.a)(N,2),R=C[0],z=C[1];var I=function(){var e=Object(l.a)(o.a.mark((function e(r){var i,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r.preventDefault(),i=!0,c=0;c<p.length;c++)p[c].roomName===S&&(i=!1);if(!i){e.next=8;break}return e.next=6,s.doc(S.toUpperCase()).set({uid:n,roomName:S.toUpperCase(),createdBy:a,createdOn:f.a.firestore.FieldValue.serverTimestamp()});case 6:e.next=9;break;case 8:alert("Name already taken");case 9:if(!i){e.next=14;break}return e.next=12,w.collection("joined").doc(t.uid).set({joined:f.a.firestore.FieldValue.arrayUnion(S.toUpperCase()),uid:t.uid},{merge:!0});case 12:e.next=15;break;case 14:console.log("bad luck");case 15:A("");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsx)(y.Fragment,{children:i?Object(y.jsx)(k,{currentRoom:b,setCurrentRoom:m}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("main",{style:{display:"block"},children:Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{className:"search",style:{display:"flex",flexDirection:"row",alignItems:"center",borderRadius:"30px",paddingRight:"20px",boxShadow:"0px 5px 20px #6b6b6b64",marginTop:"20px"},children:[Object(y.jsx)("input",{value:R,onChange:function(e){return z(e.target.value)},placeholder:"Search room...",style:{width:"100vw",border:"none",textTransform:"capitalize"}}),Object(y.jsx)(x.a,{style:{fontSize:"30px"},onClick:function(){!function(){for(var e=!1,t=0;t<p.length;t++)p[t].roomName.toUpperCase()===R.toUpperCase()&&(e=!0);e?(m(R.toUpperCase()),c(!0)):(alert("Room does not exist"),A(""))}()}})]}),Object(y.jsxs)("div",{style:{borderRadius:"20px",padding:"0 10px",marginTop:"20px"},children:[h[0]?Object(y.jsx)("h2",{style:{color:"#007AFF",fontSize:"20px"},children:"Joined rooms"}):Object(y.jsx)("div",{}),p&&p.map((function(e,t){var n=!1;if(h[0])for(var r=0;r<h[0].joined.length;r++)h[0].joined[r]===e.roomName&&(n=!0);return n?Object(y.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"5px 0px",borderLeft:"4px solid #007AFF",background:"#007AFF12",marginBottom:"10px",paddingLeft:"5px",height:"min-content"},onClick:function(){m(e.roomName),c(!0)},children:[Object(y.jsx)("img",{src:"https://avatars.dicebear.com/api/identicon/"+e.roomName+".svg?background=black&scale=70&",alt:"",style:{margin:"0",marginRight:"20px",height:"50px",width:"50px",borderRadius:"100%"}}),Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"-webkit-fill-available"},children:[Object(y.jsxs)("div",{style:{display:"flex"},children:[Object(y.jsx)("h1",{style:{textAlign:"left",margin:"3px 0",textTransform:"capitalize",fontSize:"20px",display:"flex",alignItems:"center"},children:e.roomName.toLowerCase()}),Object(y.jsx)("div",{style:{flex:"1"}}),Object(y.jsx)("h1",{style:{textAlign:"left",margin:"0px 10px",textTransform:"capitalize",fontSize:"15px",display:"flex",color:"gray",alignItems:"center"},children:e.LastMessageSender?u()(e.LastMessageTime.toDate().toISOString()).fromNow():""})]}),e.LastMessageSender?Object(y.jsxs)("h5",{style:{textAlign:"left",margin:"0",color:"gray",display:"flex",flexDirection:"column"},children:[e.LastMessageSender,": ",e.LastMessage.slice(0,10)]}):Object(y.jsx)("h4",{style:{textAlign:"left",margin:"0",color:"gray",display:"flex"},children:"No messages"})]},t)]},t):Object(y.jsx)("div",{})}))]})]})}),Object(y.jsx)("form",{onSubmit:I,style:{width:"70vw"},children:Object(y.jsxs)("div",{className:"message_box",children:[Object(y.jsx)("input",{value:S,onChange:function(e){return A(e.target.value)},placeholder:"Room name...",style:{width:"40vw"}}),Object(y.jsx)("button",{type:"submit",disabled:!S,className:"sendbtn",children:"Add"})]})})]})})}var N=function(){var e=Object(r.useState)(!1),n=Object(d.a)(e,2),a=n[0],i=n[1];function c(){i((function(e){return!e}))}w.collection("joined").where("uid","==",t.uid).get().then((function(e){e.forEach((function(e){e.data().joined.map((function(e){e===b&&i(!0)}))}))}));var s=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.collection("joined").doc(t.uid).set({joined:f.a.firestore.FieldValue.arrayUnion(b),uid:t.uid},{merge:!0});case 2:c();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.collection("joined").doc(t.uid).update({joined:f.a.firestore.FieldValue.arrayRemove(b)});case 2:c();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a?Object(y.jsx)("div",{style:{border:"1px solid #007AFF",borderRadius:"10px",padding:"5px 5px",marginRight:"5px"},children:Object(y.jsx)("h6",{style:{color:"#007AFF",fontSize:"15px",margin:"0"},onClick:function(){return j()},children:"Joined"})}):Object(y.jsx)("div",{style:{border:"1px solid #007AFF",borderRadius:"10px",padding:"5px 5px",marginRight:"5px"},children:Object(y.jsx)("h6",{style:{color:"#007AFF",fontSize:"15px",margin:"0"},onClick:function(){return s()},children:"Join"})})};return Object(y.jsxs)("div",{className:"App",children:[i?Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)("header",{children:[Object(y.jsx)("h1",{style:{margin:"0px",fontSize:"20px"},children:Object(y.jsx)("p",{style:{display:"flex"},children:Object(y.jsxs)("font",{color:"#007AFF",style:{display:"flex",alignItems:"center",textTransform:"capitalize"},children:[Object(y.jsx)(p.a,{style:{fontSize:"30px"},onClick:function(){c((function(e){return!e}))}}),Object(y.jsx)("img",{src:"https://avatars.dicebear.com/api/identicon/"+b+".svg?background=black&scale=70&",alt:"",style:{margin:"0px 5px"}}),b.toLowerCase()]})})}),Object(y.jsx)(N,{})]})}):Object(y.jsxs)("header",{style:{background:"#007bff00"},children:[Object(y.jsx)("h1",{style:{margin:"0px",fontSize:"25px"},children:Object(y.jsx)("font",{color:"#007AFF",children:"Chatbud"})}),Object(y.jsx)(S,{})]}),Object(y.jsx)("section",{children:t?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(A,{currentRoom:b,setCurrentRoom:m})," "]}):Object(y.jsx)(F,{})})]})};i.a.render(Object(y.jsx)(N,{}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.9530c736.chunk.js.map